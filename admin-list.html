<!DOCTYPE html>
<html class="x-admin-sm">

<head>
  <meta charset="UTF-8">
  <title>欢迎页面-X-admin2.2</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
    content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
  <link rel="stylesheet" href="./css/font.css">
  <link rel="stylesheet" href="./css/xadmin.css">
  <script src="./lib/layui/layui.js" charset="utf-8"></script>
  <script type="text/javascript" src="./js/xadmin.js"></script>
  <!--[if lt IE 9]>
          <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
          <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
  <style>
    .page-bar {
      margin: 40px;
      transform: translateY(50%);
      /**上移元素**/
      -ms-transform: translateY(-50%);
      -webkit-transform: translateY(-50%);

    }

    ul,
    li {
      margin: 0px;
      padding: 0px;
      top: 20px;
    }

    li {
      list-style: none
    }

    .page-bar li:first-child>a {
      margin-left: 800px;
      top: -20px;

    }

    .page-bar a {
      border: 1px solid #ddd;
      text-decoration: none;
      position: relative;
      float: left;
      padding: 6px 12px;
      margin-left: -1px;
      line-height: 1.42857143;
      color: #337ab7;
      cursor: pointer;

      top: -20px;
    }

    .page-bar a:hover {
      background-color: #eee;
    }

    .page-bar a.banclick {
      cursor: not-allowed;
    }

    .page-bar .active a {
      color: #fff;
      cursor: default;
      background-color: #337ab7;
      border-color: #337ab7;
    }

    .page-bar i {
      font-style: normal;
      color: #d44950;
      margin: 0px 4px;
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div id="app">
    <div class="x-nav">
      <span class="layui-breadcrumb">
        <a href="">桌面</a>
        <a href="">会员管理</a>
        <a>
          <cite>变更银行卡类型</cite></a>
      </span>
      <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right"
        onclick="location.reload()" title="刷新">
        <i class="layui-icon layui-icon-refresh" style="line-height:30px"></i></a>
    </div>
    <div class="layui-fluid">
      <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
          <div class="layui-card">

            <div class="layui-card-body ">
              <table class="layui-table layui-form">
                <thead>
                  <tr>

                    <th>ID</th>
                    <th>用户名</th>
                    <th>银行卡号</th>
                    <th>卡种</th>
                    <th>备注</th>
                    <th>时间</th>
                    <th>状态</th>
                    <th>操作</th>
                </thead>
                <tbody>
                  <tr v-for="managerTranscation in managerTranscations">
                    <td>{{managerTranscation.transcationId}}</td>
                    <td>{{managerTranscation.bankUser.userName}}</td>
                    <td>{{managerTranscation.bankCard}}</td>
                    <td v-if="managerTranscation.transcationType == 0">提升卡种</td>
                    <td v-if="managerTranscation.transcationType == 1">冻结银行卡</td>
                    <td>{{managerTranscation.transcationMsg}}</td>
                    <td>{{managerTranscation.gmtCreate}}</td>
                    <td class="td-status" v-if="managerTranscation.transcationStatus == 0">
                      <span class="layui-btn layui-btn-normal layui-btn-mini ">申请中</span></td>
                    <td class="td-manage">
                      <span @click="adopt(managerTranscation.transcationId)" href="javascript:;" title="通过">
                        <i class="layui-icon">&#xe601;</i>
                      </span>
                      <span @click="NoPassage(managerTranscation.transcationId)" href="javascript:;" title="不通过">
                        <i class="layui-icon">&#xe601;</i>
                      </span>
                    </td>

                  </tr>
                </tbody>
              </table>
            </div>
            <div class="layui-card-body ">
              <div class="page-bar">
                <ul>
                  <li v-if=" pageNum>1"><a v-on:click=" pageNum--,pageClick()">上一页</a>
                  </li>
                  <li v-if=" pageNum==1"><a class="banclick">上一页</a></li>
                  <li v-for="index in indexs" v-bind:class="{ 'active':  pageNum == index}">
                    <a v-on:click="btnClick(index)">{{ index }}</a>
                  </li>
                  <li v-if="pageNum!= totalPageNum"><a v-on:click=" pageNum++,pageClick()">下一页</a></li>
                  <li v-if="pageNum == totalPageNum"><a class="banclick">下一页</a></li>
                  <li><a>共<i>{{this.totalPageNum}}</i>页</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="js/vuejs-2.5.16.js"></script>
<script src="js/axios-0.18.0.js"></script>
<script src="js/mock-min.js"></script>
<script src="js/api.js"></script>
<script src="components/top.js"></script>
<script src="components/search.js"></script>
<script>
  new Vue({
    el: "#app",
    data: {
      managerTranscations: [],
 

        pageNum: 0,
      
    
      totalPageNum: 0, //总页数
    },
    methods: {
      //查询所有
      getManagerTranscations: function () {
        getManagerTranscations(this.pageNum).then(res => {
          if (res.data.data.errno == 0) {
            this.managerTranscations = res.data.data.data;
            this.totalPageNum = res.data.data.totalPageNum;
          }
        })
      },
      //通过
      adopt: function (id) {
        adopt(id).then(res => {
          if (res.data.data.errno == 0) {
            layer.msg('已通过!', { icon: 6, time: 1000 });
            this.getManagerTranscations();
          }
        })
      },
      //不通过
      NoPassage: function (id) {
        NoPassage(id).then(res => {
          if (res.data.data.errno == 0) {
            layer.msg('已退回!', { icon: 5, time: 1000 });
            this.getManagerTranscations();
          }
        })

      },
      btnClick: function (data) {//页码点击事件
        if (data != this.pageNum) {
          this.pageNum = data;
          this.getManagerTranscations();
        }


      },
      pageClick: function () {
        console.log('现在在' + this.pageNum + '页');
        this.getManagerTranscations();
      },

    },
    created() {
      //查询所有
      this.getManagerTranscations();

    },
    computed: {
      indexs: function () {
        var left = 1;
        var right = this.totalPageNum;
        var ar = [];
        if (this.totalPageNum >= 5) {
          if (this.bankUser.pageNum > 3 && this.bankUser.pageNum < this.totalPageNum - 2) {
            left = this.bankUser.pageNum - 2
            right = this.bankUser.pageNum + 2
          } else {
            if (this.bankUser.pageNum <= 3) {
              left = 1
              right = 5
            } else {
              right = this.totalPageNum
              left = this.totalPageNum - 4
            }
          }
        }
        while (left <= right) {
          ar.push(left)
          left++
        }
        return ar
      }

    }
  })
</script>








<script>
  layui.use(['laydate', 'form'], function () {
    var laydate = layui.laydate;
    var form = layui.form;

    //执行一个laydate实例
    laydate.render({
      elem: '#start' //指定元素
    });

    //执行一个laydate实例
    laydate.render({
      elem: '#end' //指定元素
    });
  });

  /*用户-停用*/
  function member_stop(obj, id) {
    layer.confirm('确认要停用吗？', function (index) {

      if ($(obj).attr('title') == '启用') {

        //发异步把用户状态进行更改
        $(obj).attr('title', '停用')
        $(obj).find('i').html('&#xe62f;');

        $(obj).parents("tr").find(".td-status").find('span').addClass('layui-btn-disabled').html('已停用');
        layer.msg('已停用!', { icon: 5, time: 1000 });

      } else {
        $(obj).attr('title', '启用')
        $(obj).find('i').html('&#xe601;');

        $(obj).parents("tr").find(".td-status").find('span').removeClass('layui-btn-disabled').html('已启用');
        layer.msg('已启用!', { icon: 5, time: 1000 });
      }

    });
  }

  /*用户-删除*/
  function member_del(obj, id) {
    layer.confirm('确认要删除吗？', function (index) {
      //发异步删除数据
      $(obj).parents("tr").remove();
      layer.msg('已删除!', { icon: 1, time: 1000 });
    });
  }



  function delAll(argument) {

    var data = tableCheck.getData();

    layer.confirm('确认要删除吗？' + data, function (index) {
      //捉到所有被选中的，发异步进行删除
      layer.msg('删除成功', { icon: 1 });
      $(".layui-form-checked").not('.header').parents('tr').remove();
    });
  }
</script>
<script>var _hmt = _hmt || []; (function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?b393d153aeb26b46e9431fabaf0f6190";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();</script>

</html>